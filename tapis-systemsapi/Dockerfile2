##########################################################################
# Dockerfile for Tapis systems service
#
#   $TAG            the tag for image identification
#
##########################################################################
FROM tomcat:8.5-jdk13-openjdk-oracle

ARG VER
ARG GIT_COMMIT

MAINTAINER CIC Support <cicsupport@tacc.utexas.edu>

WORKDIR /app

# Copy jar file into place
COPY target/v3#systems.jar .


# Environment variables for testing without JWT
ENV TAPIS_ENVONLY_ALLOW_TEST_HEADER_PARMS true
ENV TAPIS_ENVONLY_JWT_OPTIONAL true
ENV TAPIS_ENVONLY_SKIP_JWT_VERIFY true

# Other environment variables
ENV TAPIS_REQUEST_LOGGING_FILTER_PREFIXES /v3/systems

# TODO turn on debuggin
# Debug port and http port
EXPOSE 8000
# EXPOSE 8080

CMD ["java", "-jar", "v3#systems.jar"]
